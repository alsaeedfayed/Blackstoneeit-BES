<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="form-title mb-0">{{ "shared.documents" | translate }}</h3>

  <div class="d-flex justify-content-end align-items-center">
    <div class="mr-2" *ngIf="!saveInMemory">
      <app-select
        class="filter-select"
        [placeholder]="'shared.filterBy' | translate"
        [items]="filterItems"
        [value]="'All'"
        [bindVlaue]="'name'"
        [bindLabel]="lang == 'ar' ? 'nameAr' : 'name'"
        (change)="onFilter($event)"
      ></app-select>
    </div>

    <button class="btn btn-main" (click)="onAddDocument()" *ngIf="AllowAddDocument">
      <i class="bx bx-plus"></i>
      {{ "shared.addDocument" | translate }}
    </button>
  </div>
</div>

<div class="documents-table-wrapper">
  <table class="table">
    <thead>
      <tr>
        <th scope="col" class="file-name">{{ "shared.name" | translate }}</th>
        <th scope="col">{{ "shared.uploadDate" | translate }}</th>
        <th scope="col">{{ "shared.uploadedBy" | translate }}</th>
        <th scope="col">{{ "shared.description" | translate }}</th>
        <th scope="col" *ngIf="!saveInMemory">{{ "shared.tag" | translate }}</th>
        <!-- <th scope="col">{{ "shared.actions" | translate }}</th> -->
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of documents; let i = index">
        <td class="file-name">
          <div class="attachment">
            <i class="bx bx-file"></i>
            <a class="hoverableLink" (click)="openFile(item?.attachment?.fileName)" target="_blank">
              {{ item?.attachment?.uploadedFileName }}
            </a>
          </div>
        </td>
        <td>
          {{
            lang === "en" ?
            ((item?.uploadedDate | uTCToLocalDate) | date : "dd/MM/yyyy hh:mm a") :
            ((item?.uploadedDate | uTCToLocalDate) | localizeDate : "dd/MM/yyyy hh:mm a")
          }}
        </td>
        <td>
          <person-item
            *ngIf="item?.uploadedBy"
            [ownerItem]="item?.uploadedBy"
            [CompMode]="2"
            [noCursor]="true"
            [isUserCardFixed]="true"
          ></person-item>
          <span class="rectangle-badge badge-muted" *ngIf="!item?.uploadedBy">{{ "shared.N/A" | translate }}</span>
        </td>
        <td>
          <p class="desc" *ngIf="item?.description">{{ item?.description }}</p>
          <span class="rectangle-badge badge-muted" *ngIf="!item?.description">{{ "shared.N/A" | translate }}</span>
        </td>
        <td *ngIf="!saveInMemory">
          <span class="project-card-status-badge secondary">
            {{ item?.tags[0]?.title[lang] }}
          </span>
        </td>
        <!-- <td>
          <div class="d-flex justify-content-end align-items-center h-100">
            <app-dropdown
              [items]="documentsDropdownOptions"
              (select)="onSelectOption($event, item?.id)"
            ></app-dropdown>
          </div>
        </td> -->
      </tr>
    </tbody>
  </table>
</div>

<div class="mt-4" *ngIf="documents?.length === 0">
  <app-empty-state
    [title]="'shared.noDocumentsYet' | translate"
  ></app-empty-state>
</div>

<app-project-document-modal
  [projectId]="projectId"
  [saveInMemory]="saveInMemory"
  [popupConfig]="popupConfig"
  (refreshParentComponent)="getProjectDocuments(projectId)"
  (onSaveInMemory)="saveDocToMemory($event)"
></app-project-document-modal>
