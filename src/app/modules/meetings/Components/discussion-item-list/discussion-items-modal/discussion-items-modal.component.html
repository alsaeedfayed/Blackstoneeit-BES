<div class="new-model-dialog-body">
  <ng-container *ngIf="loading; else formData">
    <div class="mt-4">
      <ng-container [ngTemplateOutlet]="skeleton"></ng-container>
    </div>
  </ng-container>

  <ng-template #formData>
    <div class="discussion-item-form pb-2" [formGroup]="form">

      <div class="mt-3">
        <app-filed
          formControlName="title"
          [control]="form | getControl: 'title'"
          [title]="'Meetings.discussionItem' | translate"
          [placeholder]="'Meetings.enterDiscussionItem' | translate"
        ></app-filed>
      </div>

      <div class="mt-3">
        <app-select
          formControlName="presenter"
          [control]="form | getControl: 'presenter'"
          [title]="'Meetings.presenter' | translate"
          [placeholder]="'Meetings.selectPresenter' | translate"
          [items]="filteredUsers"
          bindValue="id"
          [bindLabel]="'userInfo.fullName'"
          [multiple]="false"
          [clearable]="true"
          [noItemsText]="'Meetings.noAttendeesFound'"
        ></app-select>
      </div>

      <div class="mt-3">
        <app-filed
          formControlName="duration"
          [control]="form | getControl: 'duration'"
          [title]="'Meetings.Duration' | translate"
          [placeholder]="'Meetings.enterDuration' | translate"
        ></app-filed>
      </div>

      <div class="mt-3">
        <app-textarea-filed
          formControlName="notes"
          [control]="form | getControl: 'notes'"
          [title]="'Meetings.Description' | translate"
          [placeholder]="'Meetings.enterDescription' | translate"
        ></app-textarea-filed>
      </div>

      <div class="mt-3">
        <app-description-input-with-attachments
          [isTitle]="false"
          (attachmentUploadEvent)="uploadFile($event)"
          [prevAttachment]="prevUploadedFiles" 
          (onDelete)="deleteAttachment($event)"
          [maxFileSizeInMB]="5">
        </app-description-input-with-attachments>
      </div>
    </div>
  </ng-template>
</div>

<!-- footer buttons -->
<div class="new-model-dialog-footer">

  <!-- back button -->
  <button
    class="btn btn-dark flex-grow-1"
    (click)="closePopup()"
  >
    {{ 'shared.back' | translate }}
  </button>

  <!-- save button -->
  <button
    class="btn btn-main flex-grow-1"
    [disabled]="form?.invalid || isBtnLoading"
    (click)="addDiscussionItems()"
  >
    <i class="bx bx-loader-alt bx-spin ml-1" *ngIf="isBtnLoading"></i>
    {{ 'shared.save' | translate }}
  </button>
</div>

<ng-template #skeleton>
  <app-skeleton-loader mode="table"></app-skeleton-loader>
  <app-skeleton-loader mode="table"></app-skeleton-loader>
  <app-skeleton-loader mode="table"></app-skeleton-loader>
  <app-skeleton-loader mode="table"></app-skeleton-loader>
</ng-template>
